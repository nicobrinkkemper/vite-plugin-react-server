{"version":3,"file":"options.js","sourceRoot":"","sources":["../../plugin/options.ts"],"names":[],"mappings":"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","sourcesContent":["import path from \"node:path\";\nimport type { InputOption } from \"rollup\";\nimport type { ConfigEnv, ResolvedBuildOptions, ResolvedConfig, UserConfig } from \"vite\";\nimport type {\n  ResolvedUserConfig,\n  ResolvedUserOptions,\n  StreamPluginOptions,\n} from \"./types.js\";\nimport { mergeInputs } from \"./build/mergeInputs.js\";\n// Default configuration values\nexport const DEFAULT_CONFIG = {\n  FILE_REGEX: /\\.(m|c)?(j|t)sx?$/,\n  CLIENT_ASSETS_DIR: \"assets\",\n  RSC_DIR: \"rsc\",\n  MODULE_BASE: \"src\",\n  MODULE_BASE_PATH: \"/src\",\n  MODULE_BASE_URL: \"/src\",\n  PAGE: \"/src/page/page.tsx\",\n  PROPS: \"/src/page/props.ts\",\n  CLIENT_ENTRY: \"/src/client.tsx\",\n  PAGE_EXPORT: \"Page\",\n  PROPS_EXPORT: \"props\",\n  // Just to make sure the paths are correct for the plugin user\n  WORKER_PATH:\n    \"/node_modules/vite-plugin-react-server/dist/plugin/worker/worker.js\",\n  LOADER_PATH:\n    \"/node_modules/vite-plugin-react-server/dist/plugin/loader/loader.js\",\n  RSC_EXTENSION: \".rsc\",\n  HTML: ({ children }: { children: any }) => children,\n  COLLECT_CSS: true,\n  COLLECT_ASSETS: true,\n  // TODO, not used yet\n  PAGE_PATTERN: \"/src/page/**/*.page.tsx\",\n  PROPS_PATTERN: \"/src/page/**/*.props.ts\",\n  DEV_PORT: 5173,\n  PREVIEW_PORT: 4173,\n  DEV_HOST: \"localhost\",\n  PREVIEW_HOST: \"localhost\",\n  ENV_PREFIX: \"VITE_\",\n  BUILD: {\n    pages: () => [\"/\"],\n    client: \"dist/client\",\n    server: \"dist/server\",\n  },\n  // TODO, not used yet\n  AUTO_DISCOVER: {\n    pagePattern: \"**/*.page.tsx\",\n    propsPattern: \"**/*.props.ts\",\n  },\n} as const;\n\nexport function validateResolvedConfig(config: ResolvedConfig): asserts config is ResolvedConfig {\n  if (\n    typeof config === \"object\" &&\n    config != null &&\n    \"build\" in config &&\n    typeof config.build === \"object\" &&\n    config.build != null &&\n    \"rollupOptions\" in config.build &&\n    typeof config.build.rollupOptions === \"object\" &&\n    config.build.rollupOptions != null &&\n    \"input\" in config.build.rollupOptions &&\n    typeof config.build.rollupOptions.input === \"object\" &&\n    config.build.rollupOptions.input != null\n  ) {\n    return undefined; \n  }\n  throw new Error(\"Invalid config\");\n};\n\nexport const resolveUserConfig = (\n  condition: \"react-client\" | \"react-server\",\n  config: UserConfig,\n  configEnv: ConfigEnv,\n  userOptions: ResolvedUserOptions\n):\n  | { type: \"error\"; error: Error }\n  | {\n      type: \"success\";\n      userConfig: ResolvedUserConfig;\n    } => {\n  const isReactServer = condition === \"react-server\";\n  const isViteServer = configEnv.command === \"serve\";\n  const isVitePreview = configEnv.isPreview;\n\n  if (isReactServer && configEnv.command === \"build\") {\n    if (!config.build?.rollupOptions?.input) {\n      config = {\n        ...config,\n        build: {\n          ...config.build,\n          rollupOptions: {\n            ...config.build?.rollupOptions,\n          },\n        },\n      };\n    }\n  }\n\n  if (\n    typeof config.build?.assetsDir === \"string\" &&\n    userOptions.assetsDir !== config.build?.assetsDir\n  ) {\n    return {\n      type: \"error\",\n      error: new Error(\n        `assetsDir cannot be changed after the config has been resolved, before: ${userOptions.assetsDir}, after: ${config.build?.assetsDir}`\n      ),\n    };\n  }\n\n  if (isReactServer) {\n    if (configEnv.command === \"build\") {\n      if (!configEnv.isSsrBuild) {\n        return {\n          type: \"error\",\n          error: new Error(\n            \"ssr must be true when using the server plugin, NODE_OPTIONS='--conditions react-server' vite build --ssr\"\n          ),\n        };\n      }\n    } else if (!isViteServer) {\n      return {\n        type: \"error\",\n        error: new Error(\n          isViteServer\n            ? `react-server condition was not set. Please use \\`NODE_OPTIONS='--conditions react-server' vite${\n                isVitePreview ? \" preview\" : \"\"\n              }\\``\n            : \"react-server condition was not set. Please use `NODE_OPTIONS='--conditions react-server' vite build --ssr`\"\n        ),\n      };\n    } else if (!configEnv.isSsrBuild && configEnv.command !== \"serve\") {\n      return {\n        type: \"error\",\n        error: new Error(\n          \"Vite was run with the react-server condition, but is making a client build.\"\n        ),\n      };\n    }\n  }\n\n  const { root: configRoot, mode: configMode, ...configRest } = config;\n  const {\n    outDir: configOutDir,\n    assetsDir: configAssetsDir,\n    ssr: configSsr,\n    manifest: configManifest,\n    ssrManifest: configSsrManifest,\n    ssrEmitAssets: configSsrEmitAssets,\n    target: configTarget,\n    rollupOptions: configRollupOptions,\n    ...configBuildRest\n  } = config.build ?? {};\n  if (!configRollupOptions?.input) {\n    console.warn(\"No rollup options input was provided, using default input\");\n  }\n  \n  return {\n    type: \"success\",\n    userConfig: {\n      ...configRest,\n      appType: isReactServer ? \"mpa\" : \"spa\",\n      root: configRoot ?? userOptions.projectRoot ?? process.cwd(),\n      mode: configMode ?? process.env[\"NODE_ENV\"] ?? \"production\",\n      build: {\n        ...configBuildRest,\n        rollupOptions: {\n          ...configRollupOptions,\n          input: {\n            'index': '/index.html'\n          },\n        },\n        ssr: typeof configSsr !== \"undefined\" ? configSsr : isReactServer,\n        manifest: typeof configManifest !== \"undefined\" ? configManifest : true,\n        ssrManifest:\n          typeof configSsrManifest !== \"undefined\" ? configSsrManifest : true,\n        ssrEmitAssets:\n          typeof configSsrEmitAssets !== \"undefined\"\n            ? configSsrEmitAssets\n            : true,\n        target: configTarget ?? \"es2020\",\n        outDir:\n          typeof configOutDir === \"string\"\n            ? configOutDir\n            : isReactServer\n            ? userOptions.build.server\n            : userOptions.build.client,\n        assetsDir:\n          typeof configAssetsDir === \"string\"\n            ? configAssetsDir\n            : isReactServer\n            ? \"\"\n            : DEFAULT_CONFIG.CLIENT_ASSETS_DIR,\n      },\n    },\n  };\n};\n\nexport const resolveOptions = (\n  options: StreamPluginOptions,\n  condition: \"react-client\" | \"react-server\"\n):\n  | {\n      type: \"success\";\n      userOptions: ResolvedUserOptions;\n    }\n  | {\n      type: \"error\";\n      error: Error;\n    } => {\n  const {\n    workerPath: optionsWorkerPath,\n    loaderPath: optionsLoaderPath,\n    projectRoot: optionsProjectRoot,\n    moduleBase: optionsModuleBase,\n    moduleBasePath: optionsModuleBasePath,\n    moduleBaseURL: optionsModuleBaseURL,\n    build: optionsBuild,\n    Page: optionsPage,\n    props: optionsProps,\n    Html: optionsHtml,\n    pageExportName: optionsPageExportName,\n    propsExportName: optionsPropsExportName,\n    collectCss: optionsCollectCss,\n    collectAssets: optionsCollectAssets,\n    assetsDir: optionsAssetsDir,\n    clientEntry: optionsClientEntry,\n    serverOutDir: optionsServerOutDir,\n    clientOutDir: optionsClientOutDir,\n    autoDiscover: optionsAutoDiscover,\n    moduleBaseExceptions: optionsModuleBaseExceptions,\n    ...restOptions\n  } = options;\n  const projectRoot = optionsProjectRoot ?? process.cwd();\n  /** the module base can be assumed to not have a leading slash */\n  const moduleBase =\n    typeof optionsModuleBase === \"string\"\n      ? optionsModuleBase.startsWith(path.sep)\n        ? optionsModuleBase.slice(path.sep.length)\n        : optionsModuleBase\n      : DEFAULT_CONFIG.MODULE_BASE;\n\n  if (\n    typeof optionsModuleBase === \"string\" &&\n    optionsModuleBase !== moduleBase\n  ) {\n    return {\n      type: \"error\",\n      error: new Error(\n        `moduleBase ${optionsModuleBase} is invalid, should be like ${moduleBase}`\n      ),\n    };\n  }\n\n  const moduleBasePath =\n    typeof optionsModuleBasePath === \"string\"\n      ? !optionsModuleBasePath.startsWith(path.sep)\n        ? `${path.sep}${optionsModuleBasePath}`\n        : optionsModuleBasePath\n      : `${path.sep}${moduleBase}`;\n\n  if (!moduleBasePath.includes(moduleBase)) {\n    return {\n      type: \"error\",\n      error: new Error(\n        `moduleBasePath ${moduleBasePath} is invalid, should include moduleBase ${moduleBase}`\n      ),\n    };\n  }\n\n  const moduleBaseURL =\n    typeof optionsModuleBaseURL === \"string\"\n      ? !optionsModuleBaseURL.endsWith(moduleBasePath)\n        ? path.join(optionsModuleBaseURL, moduleBasePath)\n        : optionsModuleBaseURL\n      : moduleBasePath;\n\n  if (!moduleBaseURL.includes(moduleBasePath)) {\n    return {\n      type: \"error\",\n      error: new Error(\n        `moduleBaseURL ${moduleBaseURL} is invalid, should include moduleBasePath ${moduleBasePath}`\n      ),\n    };\n  }\n\n  if (\n    typeof optionsModuleBaseURL === \"string\" &&\n    optionsModuleBaseURL !== moduleBaseURL\n  ) {\n    return {\n      type: \"error\",\n      error: new Error(\n        `moduleBaseURL ${optionsModuleBaseURL} is invalid, should be like ${moduleBaseURL}`\n      ),\n    };\n  }\n\n  const build = optionsBuild\n    ? {\n        client: optionsBuild.client ?? DEFAULT_CONFIG.BUILD.client,\n        pages: optionsBuild.pages ?? DEFAULT_CONFIG.BUILD.pages,\n        server: optionsBuild.server ?? DEFAULT_CONFIG.BUILD.server,\n      }\n    : DEFAULT_CONFIG.BUILD;\n\n  const autoDiscover =\n    typeof optionsAutoDiscover === \"object\"\n      ? {\n          pagePattern:\n            typeof optionsAutoDiscover.pagePattern === \"string\"\n              ? optionsAutoDiscover.pagePattern\n              : DEFAULT_CONFIG.AUTO_DISCOVER.pagePattern,\n          propsPattern:\n            typeof optionsAutoDiscover.propsPattern === \"string\"\n              ? optionsAutoDiscover.propsPattern\n              : DEFAULT_CONFIG.AUTO_DISCOVER.propsPattern,\n        }\n      : DEFAULT_CONFIG.AUTO_DISCOVER;\n\n  const workerPath =\n    typeof optionsWorkerPath === \"string\"\n      ? optionsWorkerPath\n      : DEFAULT_CONFIG.WORKER_PATH;\n  const loaderPath =\n    typeof optionsLoaderPath === \"string\"\n      ? optionsLoaderPath\n      : DEFAULT_CONFIG.LOADER_PATH;\n  const moduleBaseExceptions =\n    condition !== \"react-server\"\n      ? [\"index\", ...(optionsModuleBaseExceptions ?? [])]\n      : [workerPath, loaderPath, ...(optionsModuleBaseExceptions ?? [])];\n  return {\n    type: \"success\",\n    userOptions: {\n      ...restOptions,\n      moduleBase,\n      moduleBasePath,\n      moduleBaseURL,\n      build,\n      Page: optionsPage ?? DEFAULT_CONFIG.PAGE,\n      props: optionsProps ?? DEFAULT_CONFIG.PROPS,\n      Html: optionsHtml ?? DEFAULT_CONFIG.HTML,\n      pageExportName: optionsPageExportName ?? DEFAULT_CONFIG.PAGE_EXPORT,\n      propsExportName: optionsPropsExportName ?? DEFAULT_CONFIG.PROPS_EXPORT,\n      collectCss: optionsCollectCss ?? DEFAULT_CONFIG.COLLECT_CSS,\n      collectAssets: optionsCollectAssets ?? DEFAULT_CONFIG.COLLECT_ASSETS,\n      projectRoot: projectRoot,\n      assetsDir: optionsAssetsDir ?? DEFAULT_CONFIG.CLIENT_ASSETS_DIR,\n      workerPath: workerPath,\n      loaderPath: loaderPath,\n      clientEntry: optionsClientEntry ?? DEFAULT_CONFIG.CLIENT_ENTRY,\n      serverOutDir: optionsServerOutDir ?? DEFAULT_CONFIG.BUILD.server,\n      clientOutDir: optionsClientOutDir ?? DEFAULT_CONFIG.BUILD.client,\n      autoDiscover: autoDiscover,\n      moduleBaseExceptions: moduleBaseExceptions,\n    } satisfies ResolvedUserOptions,\n  };\n};\n\nexport async function resolvePages(\n  pages: ResolvedUserOptions[\"build\"][\"pages\"]\n): Promise<\n  | {\n      type: \"success\";\n      pages: string[];\n    }\n  | {\n      type: \"error\";\n      error: Error;\n    }\n> {\n  if (!pages) {\n    return {\n      type: \"success\",\n      pages: [],\n    };\n  }\n  if (typeof pages === \"function\") {\n    try {\n      return resolvePages(await Promise.resolve(pages()));\n    } catch (error) {\n      return {\n        type: \"error\",\n        error:\n          error instanceof Error\n            ? error\n            : new Error(\n                `build.pages must be a array of strings, or a (async) function that returns a string or an array of strings. Got \"${JSON.stringify(\n                  pages\n                )}\"`,\n                {\n                  cause: error,\n                }\n              ),\n      };\n    }\n  }\n  try {\n    const result = pages;\n    const awaited = \"then\" in result ? await result : result;\n    if (typeof awaited === \"string\") {\n      return {\n        type: \"success\",\n        pages: [awaited],\n      };\n    }\n    if (Array.isArray(awaited)) {\n      if (awaited.every((page) => typeof page === \"string\")) {\n        return {\n          type: \"success\",\n          pages: awaited,\n        };\n      } else {\n        return {\n          type: \"error\",\n          error: new Error(\n            `build.pages must be a array of strings, or a (async) function that returns a string or an array of strings. Got \"${JSON.stringify(\n              awaited.find((page) => typeof page !== \"string\")\n            )}\"`,\n            {\n              cause: awaited,\n            }\n          ),\n        };\n      }\n    }\n    return {\n      type: \"error\",\n      error: new Error(\n        `build.pages must be a array of strings, or a (async) function that returns a string or an array of strings. Got \"${JSON.stringify(\n          pages\n        )}\"`,\n        {\n          cause: pages,\n        }\n      ),\n    };\n  } catch (error) {\n    return {\n      type: \"error\",\n      error:\n        error instanceof Error\n          ? error\n          : new Error(\n              `build.pages must be a array of strings, or a (async) function that returns a string or an array of strings. Got \"${JSON.stringify(\n                error\n              )}\"`,\n              {\n                cause: error,\n              }\n            ),\n    };\n  }\n}\n"]}